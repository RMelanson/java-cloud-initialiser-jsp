<!DOCTYPE html>
<html lang="en">
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="./hashMap.js"></script>
    <meta charset="UTF-8">
    <title>ParentTest</title>
</head>
<body onload="" onunload="cleanup()">
    <h2>Parent Window Test</h2>
    <button onclick="openChildwindow()">Open Child Window</button>
    <button onclick="closeChildwindow()">Close Child Window</button>
    <BR>
    <button onclick="checkBoxPage('userAdmin')">Check Button</button>
    <button onclick="unCheckBoxPage('userAdmin')">UnCheck Button</button>
    <BR><BR>
    <input type="checkbox" id="userAdminCB" onchange="checkOpenWindow(this)">User Admin<BR>
    <button onclick="childFunction()">Call Child Function</button>
 
    <script language="Javascript" type="text/javascript">
    var winMap = new HashMap();

 //  var userAdminWin = childWindow("ChildTest.html", "Child Button Window", "width=250, height=100", false)

    var newWin = null;

    function openChildwindow() {
        alert("OPENING CHILD WINDOW");
        if (newWin == null ){
            alert("childWindow NULL Allocating");
            newWin = childWindow("ChildTest.html", "Child Window", "width=250, height=100");
        }
        newWin.focus();
    }

    function closeChildwindow() {
        newWin.focus();
        newWin.close();
    }

    function childFunction() {
        newWin.focus();
        newWin.childFunction();
    }

    function parentFunction()
    {
        alert(" Parent Window Alert");
    }

//		  alert("CHECK BOX PAGE")
    function checkBoxPage(checkBoxId) {
        alert("checkBoxId = "+checkBoxId);
        var checkBox = document.getElementById("userAdmin");
	    checkBox.checked = true;
    }

//		  alert("HIDE "CHECK BOX PAGE")
    function unCheckBoxPage(checkBoxId) {
        alert("checkBoxId = "+checkBoxId);
        var checkBox = document.getElementById("userAdmin");
	    checkBox.checked = false;
    }

    function checkOpenWindow(cb) {
        var cbId = cb.id.substring(0, cb.id.length - "CB".length);
        var cbChecked=cb.checked;
        var cbWin=getWin(cbId);
         if (cbWin != null) {
            if (cbChecked) {
                    alert("OPENING NEW WINDOW cbWin.url = " + cbWin.url+" cbWin.target = "+cbWin.target+" cbWin.features = "+cbWin.features);
                    cbWin.obj = window.open(cbWin.url, cbWin.target, cbWin.features);
                cbWin.obj.focus();
           }
           else {
            cbWin.obj.close();
            }
        }
    }

    function  getWin(winIdKey) {
        var win = winMap.get(winIdKey);
        if (win == null) {
            win = childWindow(winIdKey,winIdKey,"width=250, height=100",true);
            winMap.put(winIdKey,win);
        }
        return win;
    }

    function childWindow(name,target,features,replace) {
       var win      = new Object();
       win.name     = null;
       win.url      = name+".html";
       win.target   = target;
       win.features = features;
       win.replace  = replace;
       win.obj=null;
       return win;
    }


   function cleanup() {
   }
</script>
</body>
</html>