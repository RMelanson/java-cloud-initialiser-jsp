<!DOCTYPE html>
<html lang="en">
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
            <meta charset="UTF-8">
    </head>
    <body onload="">
        <title>userAdmin</title>
        <h2>User Admin Window</h2>
    
        <button onclick="parentFunction()">CallParentFunction</button>
     
        <script language="Javascript" type="text/javascript">
         
         window.addEventListener("unload", function() {
            parent.console.log("child is gone");
        })
    
    //        window.onbeforeunload = closingCode;
            function closingCode(){
               alert("AAAAAAAAAAAAAAAAAAAAAA");
               return null;
            }
    
            var userAdmin = "userAdmin";
     
            function parentFunction() {
                window.opener.setCheckBox(userAdmin, false);
    //            window.opener.parentFunction(userAdmin);
                window.opener.console.log("ZZZZZZZZZZ");
                parent.console.log("Child is gone");
    //           alert("Calling Parent");
            }
     
           function parentFunctionOLD() {
                window.opener.parentFunction(userAdmin);
                window.opener.setCheckBox(userAdmin, false);
            }
    
            function callChildFunction() {
                alert("doStuffOnPopup Child Test");
            }
    
            function childFunction()
            {
                alert(" Child Window Alert");
            }
    
            function cleanup() {
                alert ("EXITING");
                window.opener.setCheckBox(userAdmin, false);
            }
        </script>


<script>
    function report( event ) {
        var payload = {
            event: event.type
        };
        alert("TaDa");
        return parent.postMessage( JSON.stringify(payload), "*" );
    }
    jQuery( window ).on( "beforeunload", function( event ) {
        report( event );
    }).on( "load", function( event ) {
        setTimeout(function() {
            window.location.reload();
        }, 50);
    });
</script>
    </body>
</html>